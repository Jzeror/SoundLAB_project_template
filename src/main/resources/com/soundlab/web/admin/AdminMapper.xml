<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.soundlab.web.admin.AdminMapper">
	<resultMap type="map" id="admin">
		<result property="songSeq" column="song_seq"/>
		<result property="musicTitle" column="music_title"/>
		<result property="genreSeq" column="genre_seq"/>
		<result property="genreName" column="genre_name"/>				
		<result property="artSeq" column="art_seq"/>
		<result property="artistSeq" column="artist_seq"/>
		<result property="artistName" column="artist_name"/>
		<result property="albumSeq" column="album_seq"/>
		<result property="albumTitle" column="album_title"/>
		<result property="age" column="age"/>
		<result property="ageGroup" column="age_group"/>
		<result property="sex" column="sex"/>
		<result property="str" column="str"/>
		<result property="good" column="good"/>
		<result property="bad" column="bad"/>
		<result property="sumStr" column="sum_str"/>
		<result property="sumGood" column="sum_good"/>
		<result property="sumBad" column="sum_bad"/>
		<result property="date" column="date"/>
		<result property="sumVisit" column="sum_visit"/>
		<result property="mVisit" column="m_sum_visit"/>
		<result property="fVisit" column="f_sum_visit"/>
		<result property="newUser" column="new_user"/>
		<result property="strm" column="strm"/>
		<result property="teen" column="10s"/>
		<result property="twent" column="20s"/>
		<result property="thir" column="30s"/>
		<result property="four" column="40s"/>
		<result property="m" column="m"/>
		<result property="f" column="f"/>
		<result property="hashSeq" column="hash_seq"/>
		<result property="day" column="day"/>
		<result property="hash" column="hash"/>
		<result property="countView" column="count_view"/>
	</resultMap>
	
	
	<!-- 방문자 -->
	<select id="cntNew" resultMap="admin">
	SELECT * FROM NR_NEW_USER 
	WHERE DATE = '2018-10-25'
	<!--  널값일때 처리해야돼 -->
	<!-- WHERE DATE = CURDATE() -->
	</select>
	<select id="countStrm" resultMap="admin">
	SELECT * FROM NR_DAY_STR
	WHERE DATE = CURDATE()
	</select>
	<select id="cntVisiter" resultMap="admin">
	SELECT * FROM NR_VISITER 
	WHERE DATE BETWEEN #{ago} AND #{now}
	</select>
	
	
	<!-- 아티스트 -->
	<select id="artistStats" resultMap="admin">
		SELECT * FROM nr_artist_stats
		WHERE ARTIST_NAME LIKE #{artistName}
	</select>
	<select id="getPerSex" resultMap="admin">
	SELECT ARTIST_NAME, SUM(M) M, SUM(F) F 
	FROM NR_ARTIST_MF
	WHERE ARTIST_NAME LIKE #{artistName}
	</select>
	<select id="getCntAge" resultMap="admin">
	SELECT * FROM NR_ARTI_AGE
	WHERE ARTIST_NAME LIKE #{artistName}
	</select>
	<select id="listTopSong" parameterType="map" resultMap="admin" >
	SELECT * FROM nr_artist_stats
		WHERE ARTIST_NAME LIKE #{artistName}
		<if test="order == 'sum_good' ">
		order by sum_good desc LIMIT 5
		</if>
		<if test="order == 'sum_bad' ">
		order by sum_bad desc LIMIT 5
		</if>
	</select>
	
	<!-- 선호도 -->
	<select id="ageGenre" resultMap="admin">
	SELECT * FROM NR_AGE_GENRE
	</select>
	<select id="ageArtist" resultMap="admin">
	SELECT * FROM NR_AGE_ARTIST
	</select> 
	<select id="sexGenre" resultMap="admin">
	SELECT * FROM NR_SEX_GENRE
	</select>
	<select id="sexArtist" resultMap="admin">
	SELECT * FROM NR_SEX_ARTIST
	WHERE ARTIST_NAME IN ("방탄소년단","레드벨벳","트와이스")
	</select>
	<select id="listTotalSong" parameterType="map" resultMap="admin" >
	SELECT * FROM nr_artist_stats
		<if test="order == 'sum_good' ">
		order by sum_good desc LIMIT 5
		</if>
		<if test="order == 'sum_bad' ">
		order by sum_bad desc LIMIT 5
		</if>
	</select>
	
	
	<!-- 해시태그 -->
	<select id="getHash" resultMap="admin">
	SELECT * FROM NR_HASH 
	<!-- <![CDATA[WHERE HASH_SEQ BETWEEN #{num}-4 AND #{num}]]> -->
	</select>
</mapper>










