<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.soundlab.web.foryou.ForYouMapper">
  <resultMap type="map" id="fy">
  	<result property="msRankA" column="MS_RANK_A"/>
  	<result property="msSeqA" column="MS_SEQ_A"/>
  	<result property="msTitleA" column="MS_TITLE_A"/>
  	<result property="msGenreA" column="MS_GENRE_A"/>
  	<result property="msArtistA" column="MS_ARTIST_A"/>
  	<result property="msArtistNameA" column="MS_ARTIST_NAME_A"/>
  	<result property="msAlbumA" column="MS_ALBUM_A"/>
  	<result property="msAlbumTitleA" column="MS_ALBUM_TITLE_A"/>
  	<result property="msRankB" column="MS_RANK_B"/>
  	<result property="msSeqB" column="MS_SEQ_B"/>
  	<result property="msTitleB" column="MS_TITLE_B"/>
  	<result property="msGenreB" column="MS_GENRE_B"/>
  	<result property="msArtistB" column="MS_ARTIST_B"/>
  	<result property="msArtistNameB" column="MS_ARTIST_NAME_B"/>
  	<result property="msAlbumB" column="MS_ALBUM_B"/>
  	<result property="msAlbumTitleB" column="MS_ALBUM_TITLE_B"/>
  	<result property="alRank" column="AL_RANK"/>
  	<result property="alArtist" column="AL_ARTIST"/>
  	<result property="alArtistName" column="AL_ARTIST_NAME"/>
  	<result property="alSeq" column="AL_SEQ"/>
  	<result property="alTitle" column="AL_TITLE"/>
  	<result property="alImgName" column="AL_IMG_NAME"/>
  	<result property="alImgExt" column="AL_IMG_EXT"/>
  	<result property="atRank" column="AT_RANK"/>
  	<result property="atArtistSeq" column="AT_ARTIST_SEQ"/>
  	<result property="atArtistName" column="AT_ARTIST_NAME"/>
  	<result property="atImgName" column="AT_IMG_NAME"/>
  	<result property="atImgExt" column="AT_IMG_EXT"/>
  	<result property="mSeq" column="MSEQ"/>
  	<result property="musicSeq" column="MUSIC_SEQ"/>
  	<result property="musicTitle" column="MUSIC_TITLE"/>
  	<result property="artistName" column="ARTIST_NAME"/>
  	<result property="albumSeq" column="ALBUM_SEQ"/>
  	<result property="albumTitle" column="ALBUM_TITLE"/>
  	
  	<result property="artistSeq" column="ARTIST_SEQ"/>
  </resultMap>
  <select id="getForYou" resultMap="fy">
	SELECT
	*
	FROM SJ_FORYOU_V SJ 
	RIGHT JOIN
	(SELECT
	IFNULL(A.MSEQ,'0') AS MSEQ,
	A.MUSIC_SEQ,
	A.MUSIC_TITLE,
	A.ARTIST_NAME,
	A.ALBUM_SEQ,
	A.ALBUM_TITLE
	FROM
	(SELECT
	ROW_NUMBER() OVER(ORDER BY M.MUSIC_SEQ) AS MSEQ,
	M.MUSIC_SEQ,
	M.MUSIC_TITLE,
	AL.ARTIST_NAME,
	M.ALBUM_SEQ,
	AL.ALBUM_TITLE
	FROM
	SJ_FORYOU_V S
	JOIN MUSIC M
	ON S.AL_SEQ LIKE M.ALBUM_SEQ
	JOIN ALBUM AL
	ON M.ALBUM_SEQ LIKE AL.ALBUM_SEQ
	WHERE S.AL_RANK LIKE 1)A
	RIGHT JOIN SJ_EMPTY_SIX SR
	ON A.MSEQ LIKE SR.NUM)DT
	ON DT.MSEQ LIKE SJ.MS_RANK_A
  </select>
  <select id="getAlbumDetail" resultMap="fy">
	SELECT
	MS.MUSIC_SEQ,
	MS.MUSIC_TITLE,
	MS.ARTIST_SEQ,
	AB.ARTIST_NAME,
	AB.ALBUM_TITLE
	FROM MUSIC MS 
	JOIN ALBUM AB
	ON MS.ALBUM_SEQ = AB.ALBUM_SEQ
	WHERE MS.ALBUM_SEQ LIKE #{p}
	ORDER BY MS.MUSIC_SEQ
  </select>
  <insert id="putMusicUp">
 	INSERT INTO UPDOWN ( MEMBER_ID , SEQ_GROUP , SG_ELEMENT , TYPES )
 	VALUES (#{id},#{seq},'music','u')
  </insert>
  <insert id="putGenreUp">
 	INSERT INTO UPDOWN ( MEMBER_ID , SEQ_GROUP , SG_ELEMENT , TYPES )
 	VALUES (#{id},#{seq},'genre','u')
  </insert>
  </mapper>